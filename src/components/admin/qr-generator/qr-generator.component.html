<div class="max-w-2xl mx-auto space-y-6">
  <div class="text-center">
    <h1 class="text-3xl font-bold">Generador de Códigos QR</h1>
    <p class="text-muted-foreground mt-1">Crea y previsualiza códigos QR para tus productos y servicios.</p>
  </div>

  <div class="bg-card rounded-xl border border-border shadow-sm p-6 space-y-4">
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium text-foreground">Tipo de Entidad</label>
        <select [value]="qrType()" (change)="onTypeChange($event)" class="mt-1 w-full px-3 py-2 bg-background border border-border rounded-md text-sm">
          <option value="product">Producto</option>
          <option value="service">Servicio</option>
          <option value="work-order">Orden de Trabajo</option>
          <option value="supplier">Proveedor</option>
          <option value="user">Usuario</option>
          <option value="queue-join">Unirse a Cola</option>
        </select>
      </div>

      <div *ngIf="qrType() !== 'queue-join'">
        <label class="block text-sm font-medium text-foreground">Seleccionar Item</label>
        @switch (qrType()) {
          @case ('product') {
            <select [value]="selectedId()" (change)="onIdChange($event)" class="mt-1 w-full px-3 py-2 bg-background border border-border rounded-md text-sm">
              <option value="" disabled>Selecciona un producto...</option>
              @for (item of products(); track item.id) {
                <option [value]="item.id">{{ item.name }} ({{ item.sku }})</option>
              }
            </select>
          }
          @case ('service') {
            <select [value]="selectedId()" (change)="onIdChange($event)" class="mt-1 w-full px-3 py-2 bg-background border border-border rounded-md text-sm">
              <option value="" disabled>Selecciona un servicio...</option>
              @for (item of services(); track item.id) {
                <option [value]="item.id">{{ item.title }}</option>
              }
            </select>
          }
          @case ('work-order') {
            <select [value]="selectedId()" (change)="onIdChange($event)" class="mt-1 w-full px-3 py-2 bg-background border border-border rounded-md text-sm">
              <option value="" disabled>Selecciona una orden...</option>
              @for (item of workOrders(); track item.id) {
                <option [value]="item.id">#{{ item.number }}</option>
              }
            </select>
          }
          @case ('supplier') {
            <select [value]="selectedId()" (change)="onIdChange($event)" class="mt-1 w-full px-3 py-2 bg-background border border-border rounded-md text-sm">
              <option value="" disabled>Selecciona un proveedor...</option>
              @for (item of suppliers(); track item.id) {
                <option [value]="item.id">{{ item.name }}</option>
              }
            </select>
          }
          @case ('user') {
            <select [value]="selectedId()" (change)="onIdChange($event)" class="mt-1 w-full px-3 py-2 bg-background border border-border rounded-md text-sm">
              <option value="" disabled>Selecciona un usuario...</option>
              @for (item of users(); track item.id) {
                <option [value]="item.id">{{ item.name }} ({{ item.email }})</option>
              }
            </select>
          }
        }
      </div>
    </div>
  </div>

  @if (qrCodeDataUrl()) {
    <div class="bg-card rounded-xl border border-border shadow-sm p-6 flex flex-col items-center gap-6 animate-in fade-in-50">
      <h2 class="text-lg font-semibold">Previsualización del Código QR</h2>
      <div class="bg-white p-4 rounded-lg shadow-inner">
        <img [src]="qrCodeDataUrl()" alt="Generated QR Code" class="w-48 h-48">
      </div>
      <button (click)="printQr()" class="w-full sm:w-auto px-6 py-2 bg-primary text-primary-foreground rounded-md font-medium hover:bg-primary/90 flex items-center justify-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
        </svg>
        <span>Imprimir QR</span>
      </button>
    </div>
  } @else {
    <div class="text-center text-muted-foreground bg-card rounded-xl border border-dashed border-border p-12">
      <p>Selecciona un tipo y un item para generar el código QR.</p>
    </div>
  }
</div>